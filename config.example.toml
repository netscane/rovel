# Rovel 配置文件示例
#
# 配置优先级（从高到低）：
# 1. 环境变量（前缀 ROVEL_，层级分隔符 __）
# 2. 配置文件（config.toml 或 config.local.toml）
# 3. 默认值
#
# 使用方法：
# 1. 复制此文件为 config.toml 或 config.local.toml
# 2. 根据需要修改配置项
# 3. config.local.toml 不会被 git 跟踪，适合本地开发配置

# ============================================================================
# 服务器配置
# ============================================================================
[server]
# 监听地址
# 环境变量: ROVEL_SERVER__HOST
host = "0.0.0.0"

# 监听端口
# 环境变量: ROVEL_SERVER__PORT
port = 5060

# 公开访问的 Base URL（供外部 TTS 服务回调下载 voice reference）
# 如果未设置，则使用 http://{host}:{port}（host 为 0.0.0.0 时替换为 localhost）
# 环境变量: ROVEL_SERVER__BASE_URL
# base_url = "http://192.168.1.100:5060"

# 静态文件服务配置（用于托管 Web 客户端）
[server.static_files]
# 是否启用静态文件服务
# 环境变量: ROVEL_SERVER__STATIC_FILES__ENABLED
enabled = false

# 静态文件目录
# 环境变量: ROVEL_SERVER__STATIC_FILES__DIR
dir = "web"

# URL 路径前缀（"/" 表示托管在根路径，API 路由优先）
# 环境变量: ROVEL_SERVER__STATIC_FILES__PATH
path = "/"

# ============================================================================
# TTS 引擎配置
# ============================================================================
[tts]
# TTS 服务基础 URL
# 环境变量: ROVEL_TTS__URL
url = "http://localhost:8000"

# 请求超时时间（秒）
# 环境变量: ROVEL_TTS__TIMEOUT_SECS
timeout_secs = 120

# 最大重试次数
# 环境变量: ROVEL_TTS__MAX_RETRIES
max_retries = 0

# ============================================================================
# 音频配置
# ============================================================================
[audio]
# 输出格式: wav, opus, mp3
# wav: 原始格式，不转码（默认）
# opus: 推荐用于实时播放，体积小，质量好
# mp3: 通用兼容格式
# 环境变量: ROVEL_AUDIO__OUTPUT_FORMAT
output_format = "wav"

# 是否启用转码
# 启用后会将 TTS 返回的 WAV 转码为指定格式
# 环境变量: ROVEL_AUDIO__TRANSCODE_ENABLED
transcode_enabled = false

# 目标比特率（bps），用于有损压缩格式
# Opus 推荐: 16000-64000 用于语音
# 环境变量: ROVEL_AUDIO__BITRATE
bitrate = 32000

# 目标采样率（Hz）
# 0 表示保持原始采样率
# 环境变量: ROVEL_AUDIO__SAMPLE_RATE
sample_rate = 0

# 声道数
# 0: 保持原始声道数
# 1: 单声道（推荐用于语音）
# 2: 立体声
# 环境变量: ROVEL_AUDIO__CHANNELS
channels = 1

# ============================================================================
# 数据库配置
# ============================================================================
[database]
# 数据库文件路径
# 环境变量: ROVEL_DATABASE__PATH
path = "data/rovel.db"

# 最大连接数
# 环境变量: ROVEL_DATABASE__MAX_CONNECTIONS
max_connections = 5

# ============================================================================
# 存储配置
# ============================================================================
[storage]
# 音频存储目录
# 环境变量: ROVEL_STORAGE__AUDIO_DIR
audio_dir = "data/audio"

# 小说 TXT 文件存储目录
# 环境变量: ROVEL_STORAGE__NOVELS_DIR
novels_dir = "data/novels"

# 音色参考音频存储目录
# 环境变量: ROVEL_STORAGE__VOICES_DIR
voices_dir = "data/voices"

# 最大存储空间（字节），0 表示不限制
# 环境变量: ROVEL_STORAGE__MAX_SIZE_BYTES
max_size_bytes = 0

# 上传文件最大大小（字节），默认 10MB
# 环境变量: ROVEL_STORAGE__MAX_UPLOAD_SIZE
max_upload_size = 10485760

# ============================================================================
# GC（垃圾回收）配置
# ============================================================================
[gc]
# 是否启用自动 GC
# 环境变量: ROVEL_GC__ENABLED
enabled = true

# GC 间隔时间（秒）
# 环境变量: ROVEL_GC__INTERVAL_SECS
interval_secs = 3600

# Session 过期时间（秒）
# 环境变量: ROVEL_GC__SESSION_EXPIRE_SECS
session_expire_secs = 86400

# 最大存储空间（字节）
# 环境变量: ROVEL_GC__MAX_STORAGE_BYTES
max_storage_bytes = 10737418240  # 10 GB

# ============================================================================
# 日志配置
# ============================================================================
[log]
# 日志级别: trace, debug, info, warn, error
# 环境变量: ROVEL_LOG__LEVEL
level = "info"

# 是否启用 JSON 格式输出
# 环境变量: ROVEL_LOG__JSON
json = false
