# Rovel 配置文件示例
#
# 配置优先级（从高到低）：
# 1. 环境变量（前缀 ROVEL_，层级分隔符 __）
# 2. 配置文件（config.toml 或 config.local.toml）
# 3. 默认值
#
# 使用方法：
# 1. 复制此文件为 config.toml 或 config.local.toml
# 2. 根据需要修改配置项
# 3. config.local.toml 不会被 git 跟踪，适合本地开发配置

# ============================================================================
# 服务器配置
# ============================================================================
[server]
# 监听地址
# 环境变量: ROVEL_SERVER__HOST
host = "0.0.0.0"

# 监听端口
# 环境变量: ROVEL_SERVER__PORT
port = 5060

# 公开访问的 Base URL（供外部 TTS 服务回调下载 voice reference）
# 如果未设置，则使用 http://{host}:{port}（host 为 0.0.0.0 时替换为 localhost）
# 环境变量: ROVEL_SERVER__BASE_URL
# base_url = "http://192.168.1.100:5060"

# ============================================================================
# TTS 引擎配置
# ============================================================================
[tts]
# TTS 服务基础 URL
# 环境变量: ROVEL_TTS__URL
url = "http://localhost:8000"

# 请求超时时间（秒）
# 环境变量: ROVEL_TTS__TIMEOUT_SECS
timeout_secs = 120

# 最大重试次数
# 环境变量: ROVEL_TTS__MAX_RETRIES
max_retries = 0

# ============================================================================
# 数据库配置
# ============================================================================
[database]
# 数据库文件路径
# 环境变量: ROVEL_DATABASE__PATH
path = "data/rovel.db"

# 最大连接数
# 环境变量: ROVEL_DATABASE__MAX_CONNECTIONS
max_connections = 5

# ============================================================================
# 存储配置
# ============================================================================
[storage]
# 音频存储目录
# 环境变量: ROVEL_STORAGE__AUDIO_DIR
audio_dir = "data/audio"

# 小说 TXT 文件存储目录
# 环境变量: ROVEL_STORAGE__NOVELS_DIR
novels_dir = "data/novels"

# 音色参考音频存储目录
# 环境变量: ROVEL_STORAGE__VOICES_DIR
voices_dir = "data/voices"

# 最大存储空间（字节），0 表示不限制
# 环境变量: ROVEL_STORAGE__MAX_SIZE_BYTES
max_size_bytes = 0

# 上传文件最大大小（字节），默认 10MB
# 环境变量: ROVEL_STORAGE__MAX_UPLOAD_SIZE
max_upload_size = 10485760

# ============================================================================
# GC（垃圾回收）配置
# ============================================================================
[gc]
# 是否启用自动 GC
# 环境变量: ROVEL_GC__ENABLED
enabled = true

# GC 间隔时间（秒）
# 环境变量: ROVEL_GC__INTERVAL_SECS
interval_secs = 3600

# Session 过期时间（秒）
# 环境变量: ROVEL_GC__SESSION_EXPIRE_SECS
session_expire_secs = 86400

# 最大存储空间（字节）
# 环境变量: ROVEL_GC__MAX_STORAGE_BYTES
max_storage_bytes = 10737418240  # 10 GB

# ============================================================================
# 日志配置
# ============================================================================
[log]
# 日志级别: trace, debug, info, warn, error
# 环境变量: ROVEL_LOG__LEVEL
level = "info"

# 是否启用 JSON 格式输出
# 环境变量: ROVEL_LOG__JSON
json = false
